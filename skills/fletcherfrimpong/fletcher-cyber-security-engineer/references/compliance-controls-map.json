[
  {
    "check_id": "privilege_approval_required",
    "title": "Approval required before elevated access",
    "iso27001": ["A.5.15", "A.5.18"],
    "nist": ["PR.AA-01", "PR.AA-05"],
    "default_risk": "high",
    "expected_state": "Every privileged action requires explicit user approval."
  },
  {
    "check_id": "least_privilege_enforced",
    "title": "Least privilege execution mode",
    "iso27001": ["A.5.15", "A.5.18"],
    "nist": ["PR.AA-01", "PR.PS-01"],
    "default_risk": "high",
    "expected_state": "Default mode is non-root and elevated rights are scoped and short-lived."
  },
  {
    "check_id": "elevation_timeout_30m",
    "title": "Elevated session idle timeout",
    "iso27001": ["A.8.2", "A.8.15"],
    "nist": ["PR.AA-03", "DE.CM-01"],
    "default_risk": "medium",
    "expected_state": "Elevated session expires after 30 minutes of inactivity."
  },
  {
    "check_id": "audit_logging_privileged_actions",
    "title": "Privileged action audit logging",
    "iso27001": ["A.8.15", "A.8.16"],
    "nist": ["DE.AE-03", "DE.CM-01"],
    "default_risk": "medium",
    "expected_state": "All elevated approvals, commands, and privilege drops are logged."
  },
  {
    "check_id": "open_ports_approved",
    "title": "Open ports baseline approval",
    "iso27001": ["A.8.20", "A.8.21"],
    "nist": ["PR.PS-02", "DE.CM-01"],
    "default_risk": "medium",
    "expected_state": "All listening ports are approved and business-justified."
  },
  {
    "check_id": "insecure_ports_remediated",
    "title": "Insecure ports remediated",
    "iso27001": ["A.8.20", "A.8.21"],
    "nist": ["PR.PS-02", "PR.DS-02"],
    "default_risk": "high",
    "expected_state": "Insecure legacy ports are closed or migrated to secure alternatives."
  },
  {
    "check_id": "channel_allowlist_configured",
    "title": "Channel allowlist configured",
    "iso27001": ["A.5.15", "A.5.16"],
    "nist": ["PR.AA-02"],
    "default_risk": "high",
    "expected_state": "Inbound channels restrict senders via allowlists."
  },
  {
    "check_id": "group_mentions_required",
    "title": "Group mention requirement",
    "iso27001": ["A.5.16"],
    "nist": ["PR.AA-04"],
    "default_risk": "medium",
    "expected_state": "Group chats require explicit mention before agent responds."
  },
  {
    "check_id": "gateway_loopback_only",
    "title": "Gateway bound to loopback",
    "iso27001": ["A.8.9", "A.8.10"],
    "nist": ["PR.IP-01"],
    "default_risk": "high",
    "expected_state": "Gateway runs local/loopback with token auth."
  },
  {
    "check_id": "secrets_permissions_hardened",
    "title": "Secrets and config permissions hardened",
    "iso27001": ["A.8.11"],
    "nist": ["PR.DS-01"],
    "default_risk": "medium",
    "expected_state": "OpenClaw config and secrets are not world/group readable."
  },
  {
    "check_id": "runtime_privilege_hook_installed",
    "title": "Runtime privileged execution hook installed",
    "iso27001": ["A.5.15", "A.5.18"],
    "nist": ["PR.AA-01"],
    "default_risk": "high",
    "expected_state": "Privileged commands are forced through approval guard."
  },
  {
    "check_id": "alternate_privilege_paths_restricted",
    "title": "Alternate privilege paths restricted",
    "iso27001": ["A.5.15"],
    "nist": ["PR.AA-05"],
    "default_risk": "medium",
    "expected_state": "su/doas or other escalation paths are restricted or guarded."
  },
  {
    "check_id": "backup_configured",
    "title": "Backup and recovery configured",
    "iso27001": ["A.8.13"],
    "nist": ["PR.IP-04"],
    "default_risk": "low",
    "expected_state": "Backups of OpenClaw config and audit logs exist."
  },
  {
    "check_id": "update_hygiene",
    "title": "Update hygiene",
    "iso27001": ["A.8.8"],
    "nist": ["ID.RA-01"],
    "default_risk": "low",
    "expected_state": "OpenClaw is updated regularly and version is tracked."
  },
  {
    "check_id": "prompt_injection_controls",
    "title": "Prompt injection controls",
    "iso27001": ["A.5.15", "A.5.18"],
    "nist": ["PR.AA-01"],
    "default_risk": "high",
    "expected_state": "Untrusted content sources require explicit confirmation before privileged execution."
  },
  {
    "check_id": "command_policy_enforced",
    "title": "Privileged command policy enforced",
    "iso27001": ["A.5.15"],
    "nist": ["PR.AA-05"],
    "default_risk": "high",
    "expected_state": "Privileged commands are filtered by allow/deny policy."
  },
  {
    "check_id": "session_boundary_enforced",
    "title": "Task session boundary enforced",
    "iso27001": ["A.5.15"],
    "nist": ["PR.AA-03"],
    "default_risk": "medium",
    "expected_state": "Privileged approvals are scoped to a task session id."
  },
  {
    "check_id": "multi_factor_approval",
    "title": "Multi-factor approval for privileged actions",
    "iso27001": ["A.5.17"],
    "nist": ["PR.AA-02"],
    "default_risk": "medium",
    "expected_state": "Privileged approvals require an additional approval token."
  },
  {
    "check_id": "egress_allowlist_configured",
    "title": "Outbound allowlist configured",
    "iso27001": ["A.8.20"],
    "nist": ["PR.PS-02"],
    "default_risk": "medium",
    "expected_state": "Outbound destinations are allowlisted."
  },
  {
    "check_id": "egress_connections_approved",
    "title": "Outbound connections approved",
    "iso27001": ["A.8.20"],
    "nist": ["DE.CM-01"],
    "default_risk": "medium",
    "expected_state": "No unapproved outbound connections are detected."
  }
]
